E - SNS のログ  /
実行時間制限: 2 sec / メモリ制限: 1024 MB

注意
この問題に対する言及は、2019年12月29日 05:00 JST まで禁止されています。言及がなされた場合、賠償が請求される可能性があります。

試験後に総合得点や認定級を公表するのは構いませんが、どの問題が解けたかなどの情報は発信しないようにお願いします。

問題文
あなたは、N 人のユーザが参加する SNS を運営している。彼らはユーザ 1,…,N と呼ばれ、別のユーザを何人でもフォローすることができる。

しかし、あるトラブルにより、どのユーザがどのユーザをフォローしているかの情報がすべて失われてしまった。幸い、ユーザがこの SNS で行ったすべての操作のログが残っており、あなたは操作ログをもとにフォロー状況を復元しようとしている。

操作ログは Q 行からなり、その i 行目 (1≦i≦Q) は文字列 S
i
​
  である。各ユーザは以下の 3 種類の操作を行うことができ、S
i
​
  は SNS 全体で i 番目に行われた操作に対応する。

フォロー: ユーザ a がユーザ b (a

=b) をフォローする。ログには 1 a b という行が記載される。
フォロー全返し: ユーザ a が、その時点でユーザ a をフォローしているユーザ全員をフォローする。ログには 2 a という行が記載される。
フォローフォロー: その時点でユーザ a がフォローしている各ユーザ x に対し、ユーザ a が次を行う: 「その時点でユーザ x がフォローしているすべてのユーザ (ユーザ a 自身を除く) をフォローする」。ログには 3 a という行が記載される。
なお、この SNS が開設された時点では、どのユーザも誰もフォローしていなかった。また、ユーザ a がユーザ b を既にフォローしているとき、ユーザ a がユーザ b を再びフォローしても何も起こらない。

フォロー状況を復元せよ。

制約
2≦N≦100
0≦Q≦500
S
i
​
  は以下のいずれかの形式の文字列である。
1 a b (1≦a,b≦N かつ a

=b)
2 a (1≦a≦N)
3 a (1≦a≦N)
入力
入力は以下の形式で標準入力から与えられる。

N　Q
S
1
​

S
2
​

:
S
Q
​

出力
各 i,j (1≤i,j≤N) に対し、ユーザ i がユーザ j をフォローしているとき f
i,j
​
 = Y, そうでないとき f
i,j
​
 = N として、以下の形式で出力せよ。

f
1,1
​
 f
1,2
​
  … f
1,N
​

f
2,1
​
 f
2,2
​
  … f
2,N
​

:
f
N,1
​
 f
N,2
​
  … f
N,N
​

入力例 1
Copy
6 7
1 1 2
1 2 3
1 3 4
1 1 5
1 5 6
3 1
2 6
出力例 1
Copy
NYYNYY
NNYNNN
NNNYNN
NNNNNN
NNNNNY
YNNNYN
6 人のユーザ、ユーザ 1,…,6 が合計で 7 回の操作を行い、以下のようなログが残されている。

S
1
​
 : ユーザ 1 がユーザ 2 をフォローした。
S
2
​
 : ユーザ 2 がユーザ 3 をフォローした。
S
3
​
 : ユーザ 3 がユーザ 4 をフォローした。
S
4
​
 : ユーザ 1 がユーザ 5 をフォローした。
S
5
​
 : ユーザ 5 がユーザ 6 をフォローした。
S
6
​
 : ユーザ 1 がフォローフォローを実行した。操作が行われる時点でユーザ 1 がフォローしているユーザはユーザ 2,5 の二人であり、ユーザ 2 はユーザ 3 を、ユーザ 5 はユーザ 6 をフォローしている。よって、ユーザ 1 はユーザ 3,6 の二人をフォローする。
S
7
​
 : ユーザ 6 がフォロー全返しを実行した。操作が行われる時点でユーザ 6 をフォローしているユーザはユーザ 1,5 の二人であり、ユーザ 6 はこの二人をフォローする。
最終的に、フォロー状況は出力例の通りとなる。